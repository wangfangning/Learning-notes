<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta name="format-detection" content="telephone=no" />
	<meta name="wap-font-scale" content="no">
	<title>西藏商城</title>
	<link href="css/reset.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/swiper.min.css">
	<link href="css/userW.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/mobase.css">
	<link rel="stylesheet" href="css/index.css?t=12355">

	<link rel="stylesheet" href="css/main.css" />
	<link rel="stylesheet" type="text/css" href="css/sinaFaceAndEffec.css" />
	<!--<script src="js/zepto-1.1.6-min.js"></script>-->
	<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
	<script src="js/common.js?t=67554"></script>
	<script src="js/iscroll.js"></script>
	<script src="js/swiper.min.js"></script>
	<script type="text/javascript" src="js/public4.js"></script>
	<script type="text/javascript" src="js/main.js"></script>
	<script type="text/javascript" src="js/sinaFaceAndEffec.js"></script>
</head>

<body>
	<div class="mengceng">

	</div>
	<section class="tanceng">
		<h1>余额不足</h1>
		<p>
			当前余额不足，充值才可以继续送礼，是否去充值？
		</p>
		<div class="">
			<span style="border-left: none;">取消</span><span>确定</span>
		</div>

	</section>
	<div class="banner"><img src="images/banner.jpg"></div>

	<div class="message-box" id="wrapper" style="position:relative">
		<div class="message-box-nr">
			<div id="pullDown">
				<span class="pullDownIcon"></span><span class="pullDownLabel"></span>
			</div>
			<div id="thelist">

				<div class="msg-list"><em>用户</em><span class="name">小凡：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">666反了999：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">米粒1999：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">瓜子曲奇：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
				<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">去西藏穿什么装备比较合适？</span></div>
			</div>
			<div id="pullUp">
				<span class="pullUpIcon"></span><span class="pullUpLabel">Pull up to refresh...</span>
			</div>
		</div>
		<!--#include virtual="include/Swiper.html"-->
	</div>
	<div class="chongzhi">
		<p>
			充值：<span>200金币</span>
			<i>发送</i>
		</p>
		<span class="tancengan">
	  弹层
	</span>
	</div>
	<div class="input-box"><img class="face-icon" src="images/icon.png">
		<img class="click2" src="images/gongnengw2.png">
		<input type="text" placeholder="请输入您的聊天信息" class="text">
		<button type="button" class="btn">提交</button>
	</div>

	<script type="text/javascript">
		window.onload = function() {
			var height = window.innerHeight;

			var name = document.getElementsByTagName("body")[0];
			var sec1 = parseInt($(".banner").css("height"));
			var sec2 = parseInt($(".input-box").css("height"));
			var HeiG = height - sec1 + "px";

			var Hei = height - sec1 - sec2 - 30 + "px";
			// $(".swiper-container").css("height", HeiG);
			$("#wrapper").css("height", Hei);
			$("#thelist").css("height", Hei);
			name.style.height = height + "px";


		}
		var myScroll,
			pullDownEl, pullDownOffset,
			pullUpEl, pullUpOffset,
			generatedCount = 0;


		function pullUpAction() { //加载更多数据
			setTimeout(function() { // <-- Simulate network congestion, remove setTimeout from production!
				var el, li, i;
				el = document.getElementById('thelist');
				alert('加载更多数据。。。');



				myScroll.refresh(); // Remember to refresh when contents are loaded (ie: on ajax completion)
			}, 1000); // <-- Simulate network congestion, remove setTimeout from production!
		}

		function loaded() {
			pullDownEl = document.getElementById('pullDown');
			pullDownOffset = pullDownEl.offsetHeight;
			pullUpEl = document.getElementById('pullUp');
			pullUpOffset = pullUpEl.offsetHeight;

			myScroll = new iScroll('wrapper', {
				useTransition: true,
				topOffset: pullDownOffset,
				onRefresh: function() {
					if (pullDownEl.className.match('loading')) {
						pullDownEl.className = '';
						//	pullDownEl.querySelector('.pullDownLabel').innerHTML = 'Pull down to refresh...';
					} else if (pullUpEl.className.match('loading')) {
						pullUpEl.className = '';
						pullUpEl.querySelector('.pullUpLabel').innerHTML = 'Pull up to load more...';
					}
				},
				onScrollMove: function() {
					if (this.y > 5 && !pullDownEl.className.match('flip')) {
						pullDownEl.className = 'flip';
						//	pullDownEl.querySelector('.pullDownLabel').innerHTML = 'Release to refresh...';
						this.minScrollY = 0;
					} else if (this.y < 5 && pullDownEl.className.match('flip')) {
						pullDownEl.className = '';
						//	pullDownEl.querySelector('.pullDownLabel').innerHTML = 'Pull down to refresh...';
						this.minScrollY = -pullDownOffset;
					} else if (this.y < (this.maxScrollY - 5) && !pullUpEl.className.match('flip')) {
						pullUpEl.className = 'flip';
						pullUpEl.querySelector('.pullUpLabel').innerHTML = 'Release to refresh...';
						this.maxScrollY = this.maxScrollY;
					} else if (this.y > (this.maxScrollY + 5) && pullUpEl.className.match('flip')) {
						pullUpEl.className = '';
						pullUpEl.querySelector('.pullUpLabel').innerHTML = 'Pull up to load more...';
						this.maxScrollY = pullUpOffset;
					}
				},
				onScrollEnd: function() {
					if (pullDownEl.className.match('flip')) {
						pullDownEl.className = 'loading';

					} else if (pullUpEl.className.match('flip')) {
						pullUpEl.className = 'loading';
						pullUpEl.querySelector('.pullUpLabel').innerHTML = 'Loading...';
						pullUpAction(); // Execute custom function (ajax call?)
					}
				}
			});

			setTimeout(function() {
				document.getElementById('wrapper').style.left = '0';
			}, 100);
		}

		document.addEventListener('touchmove', function(e) {
			e.preventDefault();
		}, false);

		$(window).load(function() {
			loaded();
		});





		$(function() {

			$('.btn').click(function() {
				var _txt = $('.text').val();
				if (_txt == "") {

				} else {

					$('#thelist').append('<div class="msg-list"><em>用户</em><span class="name">浓茶咖啡+牛奶：</span><span class="nr">' + _txt + '</span></div>');
					//myScroll.refresh();
					setTimeout(function() {
						myScroll.refresh();
					}, 0);

					var _heg = $('.message-box-nr').height() - $('.message-box').height();
					$('.message-box-nr').css({
						"top": -_heg
					});

					$('#thelist').scrollTop($('#thelist')[0].scrollHeight);

				}

			});

		});
	</script>
	<script type="text/javascript">
		// 绑定表情
		$('.face-icon').SinaEmotion($('.text'));
		// 测试本地解析
		function out() {
			var inputText = $('.text').val();
			$('#info-show ul').append(AnalyticEmotion(inputText));
		}

		var html;

		function reply(content) {
			html = content;

			return content;
		}
	</script>
	<script>
		$(document).ready(function() {
			$(".swiper-container,.chongzhi").hide();
			$(".tanceng,.mengceng").hide();
			$(".liaotian").hide();
			$(".swiper-containerUP").show();
			$(".click2").click(function() {

				$("div.bottom").hide();
				$(".visible,.swiper-container").hide();
				$(".swiper-container,.chongzhi").show();
				$(".bottom ul").hide()

				$(".message-box-nr,.input-box").hide();


			})
			$(".click3").click(function() {
				$(".visible3").hide();
				$(".liaotian").show();

			})

			$(".swiper-slide li p").click(function(even) {
				$(".swiper-slide li p").each(function() {
					$(".swiper-slide li p").removeClass("bianxian");
					$(".swiper-slide li p .gouxuan").hide();
				})
				$(this).addClass("bianxian");
				$(this).children(".gouxuan").show();
			})
			$(".banner").click(function() {
				$(".swiper-container,.chongzhi").hide();
				$(".visible3").show();
				$(".message-box-nr,.input-box").show();
				$("div.bottom ul").show();

			})
			$(".tanceng span").click(function() {
				$(".tanceng,.mengceng").hide();

			})
			$(".tancengan").click(function() {
					$(".tanceng,.mengceng").show();

				})
				// 发送礼物
			$(".chongzhi p i").click(function() {
				// 获取图片路径
				var src = $(".swiper-slide ul li p.bianxian .ti").attr("src");
				var imgURL = src.split("/")[1];
				// 获取礼物名称
				var name = $(".swiper-slide ul li p.bianxian").siblings(".liwuname").text();
				// alert(name)
				// 字符串拼接
				var suiji = (Math.floor(Math.random() * 100)) + "px";
				var div = '<div class="ding"><div class="fangke" style="top:' + suiji + '">' + '<img src="images/headw.png" alt="" class="fangketouxiang"/>' + '<div class="user">' + '<p>' + '访客1' + '</p>' +
					'<p>' + name + '</p>' + '	</div>' + '<div class="liwudan">' + '<img src="images/' + imgURL + '	" alt=""/>' + '	</div>' + '</div></div>';


				$("body").prepend(div);

				var len = $(".fangke").size()
				for (var i = len; i >= 0; i--) {
					$(".fangke").eq(i).delay(3200).fadeOut(2000);
				}
			})
		})
	</script>
</body>

</html>
